{{!
    Copyright (C) 2018 Google Inc.
    Licensed under http://www.apache.org/licenses/LICENSE-2.0 <see LICENSE file>
}}

<div class="tree-item-wrapper {{extraClasses}}">
  <div class="flex-box tree-item-content"  ($click)="onClick($element, %event)">
  {{^if isAdminPage}}
    <tree-item-actions {instance}="instance"
                       (expand)="onExpand()"
                       (preview)="select($element)"
                       {expanded}="expanded"
                       {deep-limit}="limitDepthTree"
    ></tree-item-actions>
    {{else}}
    <div class="openclose">
      <i class="fa fa-caret-right"></i>
    </div>
    {{/if}}
    <div class="flex-box selectable-attrs width-100">
        {{#selectedColumns}}
          <div class="flex-box attr-cell">
            {{#switch attr_type}}
              {{#case 'custom'}}
                <div class="custom attr-content">
                  <tree-item-custom-attribute {instance}="instance"
                                              {custom-attribute-id}="attr_custom_attribute_id"
                  ></tree-item-custom-attribute>
                </div>
              {{/case}}
              {{#case 'admin'}}
                    <i class="fa fa-{{instance.table_singular}} color"> </i>
                     &nbsp;{{instance.title_plural}}
              {{/case}}

              {{#case 'role'}}
                <div class="roles attr-content">
                  <tree-people-with-role-list-field {instance}="instance" {role}="attr_name"/>
                </div>
              {{/case}}

              {{#case 'default'}}
                <div class="owner attr-content">
                  {{#instance}}
                    {{> attrTemplate}}
                  {{/instance}}
                </div>
              {{/case}}
           {{/switch}}
          </div>
        {{/selectedColumns}}
    </div>

    <cycle-task-actions {instance}="instance"></cycle-task-actions>

    <tree-item-extra-info {instance}="instance"></tree-item-extra-info>
  </div>

  <lazy-render trigger="expanded">
    <div class="sub-tier">
      <sub-tree-wrapper {parent}="instance"
                        {limit-depth-tree}="limitDepthTree"
                        {get-depth-filter}="@getDepthFilter"
                        {is-open}="expanded"
                        (collapse-subtree)="collapseAndHighlightItem()"
      ></sub-tree-wrapper>
    </div>
  </lazy-render>
</div>
